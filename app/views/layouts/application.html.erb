<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <%= csrf_meta_tags %>
    <%= favicon_link_tag %>
    <%= stylesheet_link_tag('application', media: 'all') %>
    <%= stylesheet_link_tag('https://fonts.googleapis.com/css?family=Roboto:400,500') %>
    <%= javascript_include_tag('application') %>

    <title><%= yield(:meta_title) %></title>
  </head>

  <body>
    <nav class="first-header navbar navbar-expand">
      <div class="container">
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav mr-auto">
            <%= link_to(t(".title"), root_path, class: "navbar-brand") %>

            <li class="nav-item">
              <select class="first-header__communities-navigation selectpicker" data-live-search="true" data-size="10" title="<%= t(".communities_navigation.title") %>">
                <% if communities_moderated_by_user.present? %>
                  <optgroup label="<%= t(".communities_navigation.mod_queues") %>">
                    <% communities_moderated_by_user.each do |community| %>
                      <option data-href="<%= community_path(community) %>"><%= community.title %></option>
                    <% end %>
                  </optgroup>
                <% end %>

                <% if communities_followed_by_user.present? %>
                  <optgroup label="<%= t(".communities_navigation.follows") %>">
                    <% communities_followed_by_user.each do |community| %>
                      <option data-href="<%= community_path(community) %>"><%= community.title %></option>
                    <% end %>
                  </optgroup>
                <% end %>
              </select>
            </li>
          </ul>

          <% if user_signed_in? %>
            <ul class="first-header__user-navigation navbar-nav">
              <li class="nav-item dropdown">
                <span class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <%= current_user.username %>
                </span>

                <div class="dropdown-menu">
                  <%= link_to(t('.user_navigation.profile'), posts_user_path(current_user), class: 'dropdown-item') %>
                  <%= link_to(t('.user_navigation.settings'), edit_users_path, class: 'dropdown-item') %>
                  <div class="dropdown-divider ml-2"></div>
                  <%= link_to(t('.user_navigation.sign_out'), sign_out_path, method: :delete, class: 'dropdown-item') %>
                </div>
              </li>
            </ul>
          <% else %>
            <span class="navbar-text">
              <%= link_to(t('.sign_up'), new_sign_up_path, remote: true, class: 'first-header__sign-up-link') %>
              <%= link_to(t('.sign_in'), new_sign_in_path, remote: true, class: 'first-header__sign-in-link') %>
            </span>
          <% end %>
        </div>
      </div>
    </nav>

    <% if content_for?(:second_header) %>
      <nav class="second-header navbar navbar-expand">
        <div class="container">
          <div class="collapse navbar-collapse">
            <%= yield(:second_header) %>
          </div>
        </div>
      </nav>
    <% end %>

    <div class="container">
      <div class="row">
        <div class="content col-9">
          <%= yield %>
        </div>

        <div class="sidebar col-3">
          <%= yield(:sidebar) %>
        </div>
      </div>
    </div>
  </body>
</html>